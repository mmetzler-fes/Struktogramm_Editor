<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Struktogramm Editor</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
	<!-- Google Fonts for a premium look -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>
	<div class="app-container">
		<aside class="sidebar">
			<h2>Toolbox</h2>
			<div class="toolbox">
				<div class="draggable-item" draggable="true" data-type="command">Command</div>
				<div class="draggable-item" draggable="true" data-type="if_else">If / Else</div>
				<div class="draggable-item" draggable="true" data-type="for_loop">For Loop</div>
				<div class="draggable-item" draggable="true" data-type="while_loop">While Loop (Head)</div>
				<div class="draggable-item" draggable="true" data-type="repeat_loop">Repeat Loop (Foot)</div>
				<div class="draggable-item" draggable="true" data-type="subprogram">Subprogram</div>
				<div class="draggable-item" draggable="true" data-type="exit">Exit</div>
			</div>
			<div class="toolbar">
				<button id="save-btn">Save Diagram</button>
				<button id="export-btn">Export Mermaid</button>
				<button id="export-nsd-btn">Export NSD SVG</button>
				<button id="export-pap-btn">Export PAP SVG</button>
			</div>
		</aside>
		<main class="editor-area">
			<div id="canvas" class="canvas">
				<!-- Diagram will be rendered here -->
				<div class="drop-zone initial-zone" data-id="root">
					<p>Drag blocks here to start</p>
				</div>
			</div>
			<div class="output-area">
				<h3>Mermaid Output</h3>
				<pre id="mermaid-output"></pre>
			</div>
		</main>
	</div>
	<div id="export-modal" class="modal"
		style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;">
		<div class="modal-content"
			style="background: white; padding: 20px; border-radius: 8px; max-width: 90%; max-height: 90%; overflow: auto; display: flex; flex-direction: column; gap: 10px;">
			<h2 id="export-title">Export Preview</h2>
			<div id="export-preview" style="border: 1px solid #ccc; padding: 10px; overflow: auto; background: white;">
			</div>
			<div style="display: flex; gap: 10px; justify-content: flex-end;">
				<button id="close-export-btn" class="btn secondary">Close</button>
				<button id="download-export-btn" class="btn primary">Download SVG</button>
			</div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
	<script>
		mermaid.initialize({ startOnLoad: false });
	</script>
	<script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>